<article class='markdown-body'><meta charset="utf-8"><link rel="stylesheet" type="text/css" href="../style.css"><h1>在不同用户的账户之间转账</h1>
<p>汇率服务使用的是：<a href="https://fixer.io/documentation" rel="nofollow">fixer.io</a><br />
浮点数舍入使用：<a href="https://simple.wikipedia.org/wiki/Rounding#Round_half_to_even" rel="nofollow">Round_half_to_even</a></p>
<p>假设有如下用户在系统中拥不同币种的账户，并且账户中有如下余额（&quot;N/A&quot;表示帐户不支持对应币种）</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1001</td>
<td>1000.00</td>
<td>N/A</td>
</tr>
<tr>
<td>qinyu</td>
<td>1002</td>
<td>N/A</td>
<td>300.00</td>
</tr>
<tr>
<td>zhongjing</td>
<td>2001</td>
<td>2000.00</td>
<td>200.00</td>
</tr>
</tbody>
</table>
<h2>在同一币种账户之间转账</h2>
<ul>
<li>
<p>用户&quot;qinyu&quot;从账户&quot;1001&quot;向用户&quot;zhongjing&quot;的账户&quot;2001&quot;转账&quot;100.00 CNY&quot;</p>
</li>
<li>
<p>转账应该成功完成</p>
</li>
<li>
<p>并且&quot;qinyu&quot;和&quot;zhongjing&quot;的账户余额应该如下：</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1001</td>
<td>900.00</td>
<td>N/A</td>
</tr>
<tr>
<td>zhongjing</td>
<td>2001</td>
<td>2100.00</td>
<td>200.00</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>用户&quot;qinyu&quot;从账户&quot;1002&quot;向用户&quot;zhongjing&quot;的账户&quot;2001&quot;转账&quot;100.00 EUR&quot;</p>
</li>
<li>
<p>转账应该成功完成</p>
</li>
<li>
<p>并且&quot;qinyu&quot;和&quot;zhongjing&quot;的账户余额应该如下：</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1002</td>
<td>N/A</td>
<td>200.00</td>
</tr>
<tr>
<td>zhongjing</td>
<td>2001</td>
<td>2000.00</td>
<td>300.00</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>用户&quot;qinyu&quot;从账户&quot;1001&quot;向用户&quot;zhongjing&quot;的账户&quot;2001&quot;转账&quot;1001.00 CNY&quot;</p>
</li>
<li>
<p>转账无法完成，提示错误消息&quot;1001 余额不足&quot;</p>
</li>
<li>
<p>并且&quot;qinyu&quot;和&quot;zhongjing&quot;的账户余额应该如下：</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1001</td>
<td>1000.00</td>
<td>N/A</td>
</tr>
<tr>
<td>zhongjing</td>
<td>1002</td>
<td>2000.00</td>
<td>200.00</td>
</tr>
</tbody>
</table>
</li>
</ul>
<h2>在不同币种账户之间转账</h2>
<p>假设当时&quot;EUR&quot;对&quot;CNY&quot;的汇率是&quot;7.771705&quot;</p>
<ul>
<li>
<p>用户&quot;zhongjing&quot;从账户&quot;2001&quot;向用户&quot;qinyu&quot;的账户&quot;1002&quot;转账&quot;100.00 CNY&quot;</p>
</li>
<li>
<p>转账应该成功完成</p>
</li>
<li>
<p>并且&quot;qinyu&quot;和&quot;zhongjing&quot;的账户余额应该如下：</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1002</td>
<td>N/A</td>
<td>312.87</td>
</tr>
<tr>
<td>zhongjing</td>
<td>1002</td>
<td>1900</td>
<td>200.00</td>
</tr>
</tbody>
</table>
</li>
<li>
<p>用户&quot;zhongjing&quot;从账户&quot;2001&quot;向用户&quot;qinyu&quot;的账户&quot;1001&quot;转账&quot;0.50 EUR&quot;</p>
</li>
<li>
<p>转账应该成功完成</p>
</li>
<li>
<p>并且&quot;qinyu&quot;和&quot;zhongjing&quot;的账户余额应该如下：</p>
<table>
<thead>
<tr>
<th>user</th>
<th>account</th>
<th>balance_in_cny</th>
<th>balance_in_eur</th>
</tr>
</thead>
<tbody>
<tr>
<td>qinyu</td>
<td>1001</td>
<td>1003.89</td>
<td>N/A</td>
</tr>
<tr>
<td>zhongjing</td>
<td>2001</td>
<td>2000</td>
<td>199.50</td>
</tr>
</tbody>
</table>
</li>
</ul>
<ul id="navigation"><center><li class="nav"><a href="./transfer_between_accounts_with_different_users_user.html"><</a></li><li class="nav"><a href="../index.html">=</a></li></center></article>